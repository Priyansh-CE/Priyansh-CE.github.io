<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Snake Arena Advanced</title>
<style>
body{margin:0;overflow:hidden;background:#020617;}
canvas{display:block}
#ui{
position:fixed;
top:15px;
left:50%;
transform:translateX(-50%);
color:white;
font-family:Arial;
text-align:center;
}
</style>
</head>
<body>

<div id="ui">
<div id="score">Score: 0</div>
<div id="stamina">Stamina: 100</div>
</div>

<canvas id="game"></canvas>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

const MAP_SIZE=3000;

let camera={x:0,y:0,zoom:1};
let keys={};

class Snake{
constructor(x,y,color,ai=false){
this.body=[];
this.length=40;
this.x=x;
this.y=y;
this.angle=0;
this.speed=120;
this.color=color;
this.ai=ai;
this.alive=true;
this.stamina=100;
for(let i=0;i<this.length;i++){
this.body.push({x:x,y:y});
}
}

update(dt){
if(!this.alive)return;

if(!this.ai){
if(keys["ArrowLeft"]) this.angle-=3*dt;
if(keys["ArrowRight"]) this.angle+=3*dt;

if(keys[" "] && this.stamina>0){
this.speed=220;
this.stamina-=40*dt;
}else{
this.speed=120;
this.stamina+=20*dt;
if(this.stamina>100)this.stamina=100;
}
}else{
this.angle+= (Math.random()-0.5)*1.5*dt;
}

this.x+=Math.cos(this.angle)*this.speed*dt;
this.y+=Math.sin(this.angle)*this.speed*dt;

this.body.unshift({x:this.x,y:this.y});
while(this.body.length>this.length){
this.body.pop();
}
}

draw(){
if(!this.alive)return;
ctx.beginPath();
for(let i=0;i<this.body.length;i++){
let p=this.body[i];
ctx.lineTo(p.x,p.y);
}
ctx.strokeStyle=this.color;
ctx.lineWidth=20;
ctx.lineCap="round";
ctx.shadowBlur=15;
ctx.shadowColor=this.color;
ctx.stroke();
ctx.shadowBlur=0;
}
}

let player=new Snake(0,0,"#22c55e",false);
let enemies=[];
for(let i=0;i<5;i++){
enemies.push(new Snake(
Math.random()*1000-500,
Math.random()*1000-500,
`hsl(${Math.random()*360},70%,60%)`,
true
));
}

let particles=[];
function explode(x,y){
for(let i=0;i<40;i++){
particles.push({
x,y,
vx:(Math.random()-0.5)*300,
vy:(Math.random()-0.5)*300,
life:1
});
}
}

function updateParticles(dt){
particles.forEach(p=>{
p.x+=p.vx*dt;
p.y+=p.vy*dt;
p.life-=dt;
});
particles=particles.filter(p=>p.life>0);
}

function drawParticles(){
particles.forEach(p=>{
ctx.fillStyle="white";
ctx.fillRect(p.x,p.y,3,3);
});
}

function checkCollision(a,b){
for(let i=5;i<b.body.length;i++){
let dx=a.x-b.body[i].x;
let dy=a.y-b.body[i].y;
if(Math.sqrt(dx*dx+dy*dy)<15){
a.alive=false;
explode(a.x,a.y);
}
}
}

let last=0;
function loop(t){
let dt=(t-last)/1000;
last=t;

ctx.clearRect(0,0,canvas.width,canvas.height);

camera.x=player.x;
camera.y=player.y;
camera.zoom=1.2;

ctx.save();
ctx.translate(canvas.width/2,canvas.height/2);
ctx.scale(camera.zoom,camera.zoom);
ctx.translate(-camera.x,-camera.y);

player.update(dt);
enemies.forEach(e=>e.update(dt));

enemies.forEach(e=>{
checkCollision(player,e);
checkCollision(e,player);
});

player.draw();
enemies.forEach(e=>e.draw());

updateParticles(dt);
drawParticles();

ctx.restore();

document.getElementById("score").innerText="Score: "+Math.floor(player.length);
document.getElementById("stamina").innerText="Stamina: "+Math.floor(player.stamina);

requestAnimationFrame(loop);
}

window.addEventListener("keydown",e=>keys[e.key]=true);
window.addEventListener("keyup",e=>keys[e.key]=false);

requestAnimationFrame(loop);
</script>
</body>
</html>
