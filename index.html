<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Real Snake Battle</title>
<style>
body{
    margin:0;
    overflow:hidden;
    background:#0a0a0a;
    font-family:Arial;
}
#ui{
    position:fixed;
    top:10px;
    left:10px;
    color:white;
    font-size:18px;
}
#menu{
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    text-align:center;
    display:none;
}
button{
    padding:10px 20px;
    margin:10px;
    font-size:16px;
    border:none;
    border-radius:8px;
    cursor:pointer;
}
#restart{background:#22c55e;}
#exit{background:#ef4444;color:white;}
</style>
</head>
<body>

<canvas id="game"></canvas>
<div id="ui">Score: <span id="score">0</span></div>

<div id="menu">
<h2 style="color:white">GAME OVER</h2>
<button id="restart">Restart</button>
<button id="exit">Exit</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player, enemies, foods;
let score = 0;
let gameOver = false;

class Snake{
    constructor(x,y,color,isAI=false){
        this.segments = [];
        this.color = color;
        this.speed = 2;
        this.isAI = isAI;
        this.angle = 0;
        for(let i=0;i<20;i++){
            this.segments.push({x:x-i*10,y:y});
        }
    }

    update(){
        if(this.isAI){
            this.angle += (Math.random()-0.5)*0.2;
        }

        let head = this.segments[0];
        let newX = head.x + Math.cos(this.angle)*this.speed;
        let newY = head.y + Math.sin(this.angle)*this.speed;

        this.segments.unshift({x:newX,y:newY});
        this.segments.pop();
    }

    grow(amount){
        for(let i=0;i<amount;i++){
            this.segments.push({...this.segments[this.segments.length-1]});
        }
    }

    draw(){
        for(let i=this.segments.length-1;i>=0;i--){
            let s = this.segments[i];
            let radius = 8 + i*0.03;
            ctx.beginPath();
            ctx.arc(s.x,s.y,radius,0,Math.PI*2);
            ctx.fillStyle = this.color;
            ctx.fill();
        }

        // Eyes
        let head = this.segments[0];
        ctx.fillStyle="white";
        ctx.beginPath();
        ctx.arc(head.x+5,head.y-3,3,0,Math.PI*2);
        ctx.fill();
    }
}

function spawnFood(x,y){
    foods.push({x,y,r:5});
}

function explodeSnake(snake){
    snake.segments.forEach(seg=>{
        spawnFood(seg.x,seg.y);
    });
}

function init(){
    player = new Snake(canvas.width/2,canvas.height/2,"#22c55e");
    enemies = [
        new Snake(200,200,"#ef4444",true),
        new Snake(800,400,"#3b82f6",true)
    ];
    foods=[];
    for(let i=0;i<100;i++){
        spawnFood(Math.random()*canvas.width,Math.random()*canvas.height);
    }
    score=0;
    gameOver=false;
    document.getElementById("menu").style.display="none";
}

canvas.addEventListener("mousemove",e=>{
    let dx = e.clientX - player.segments[0].x;
    let dy = e.clientY - player.segments[0].y;
    player.angle = Math.atan2(dy,dx);
});

function checkCollision(){
    enemies.forEach((enemy,index)=>{
        enemy.segments.forEach(seg=>{
            let dx = player.segments[0].x - seg.x;
            let dy = player.segments[0].y - seg.y;
            if(Math.hypot(dx,dy)<8){
                explodeSnake(player);
                gameOver=true;
                document.getElementById("menu").style.display="block";
            }
        });

        player.segments.forEach(seg=>{
            let dx = enemy.segments[0].x - seg.x;
            let dy = enemy.segments[0].y - seg.y;
            if(Math.hypot(dx,dy)<8){
                explodeSnake(enemy);
                enemies.splice(index,1);
            }
        });
    });
}

function update(){
    if(gameOver) return;

    ctx.fillStyle="#0a0a0a";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    player.update();
    player.draw();

    enemies.forEach(e=>{
        e.update();
        e.draw();
    });

    foods.forEach((food,i)=>{
        ctx.beginPath();
        ctx.arc(food.x,food.y,food.r,0,Math.PI*2);
        ctx.fillStyle="#facc15";
        ctx.fill();

        let dx = player.segments[0].x - food.x;
        let dy = player.segments[0].y - food.y;
        if(Math.hypot(dx,dy)<10){
            foods.splice(i,1);
            player.grow(5);
            score++;
            document.getElementById("score").innerText=score;
        }
    });

    checkCollision();
    requestAnimationFrame(update);
}

document.getElementById("restart").onclick=init;
document.getElementById("exit").onclick=()=>location.reload();

init();
update();
</script>
</body>
</html>
