<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player, foods=[];
let score=0;
let gameOver=false;

class Snake{
    constructor(x,y,color){
        this.points=[];
        this.color=color;
        this.speed=2.2;
        this.angle=0;
        this.length=300;
        this.radius=12;

        for(let i=0;i<200;i++){
            this.points.push({x:x-i,y:y});
        }
    }

    update(){
        const head = this.points[0];
        const nx = head.x + Math.cos(this.angle)*this.speed;
        const ny = head.y + Math.sin(this.angle)*this.speed;

        this.points.unshift({x:nx,y:ny});

        let totalLength=0;
        for(let i=0;i<this.points.length-1;i++){
            const dx=this.points[i].x-this.points[i+1].x;
            const dy=this.points[i].y-this.points[i+1].y;
            totalLength+=Math.hypot(dx,dy);
            if(totalLength>this.length){
                this.points.splice(i+1);
                break;
            }
        }
    }

    grow(amount){
        this.length+=amount;
    }

    draw(){
        ctx.lineCap="round";
        ctx.lineJoin="round";
        ctx.lineWidth=this.radius*2;

        const gradient=ctx.createLinearGradient(
            this.points[0].x,
            this.points[0].y,
            this.points[30]?.x || this.points[0].x,
            this.points[30]?.y || this.points[0].y
        );
        gradient.addColorStop(0,"#4ade80");
        gradient.addColorStop(1,"#166534");

        ctx.strokeStyle=gradient;
        ctx.shadowColor="#22c55e";
        ctx.shadowBlur=25;

        ctx.beginPath();
        ctx.moveTo(this.points[0].x,this.points[0].y);
        for(let i=1;i<this.points.length;i++){
            ctx.lineTo(this.points[i].x,this.points[i].y);
        }
        ctx.stroke();

        ctx.shadowBlur=0;

        // Head shine
        ctx.beginPath();
        ctx.arc(this.points[0].x,this.points[0].y,this.radius+2,0,Math.PI*2);
        ctx.fillStyle="rgba(255,255,255,0.1)";
        ctx.fill();

        // Eyes
        ctx.fillStyle="white";
        ctx.beginPath();
        ctx.arc(
            this.points[0].x+Math.cos(this.angle)*6 - Math.sin(this.angle)*4,
            this.points[0].y+Math.sin(this.angle)*6 + Math.cos(this.angle)*4,
            3,0,Math.PI*2);
        ctx.fill();
    }
}

function spawnFood(){
    foods.push({
        x:Math.random()*canvas.width,
        y:Math.random()*canvas.height,
        r:6
    });
}

function init(){
    player=new Snake(canvas.width/2,canvas.height/2,"#22c55e");
    foods=[];
    for(let i=0;i<80;i++) spawnFood();
    score=0;
    gameOver=false;
}

canvas.addEventListener("mousemove",e=>{
    player.angle=Math.atan2(
        e.clientY-player.points[0].y,
        e.clientX-player.points[0].x
    );
});

function update(){
    ctx.fillStyle="#0b1220";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    if(!gameOver){
        player.update();
        player.draw();

        foods.forEach((f,i)=>{
            const glow=ctx.createRadialGradient(f.x,f.y,1,f.x,f.y,10);
            glow.addColorStop(0,"#fde047");
            glow.addColorStop(1,"transparent");
            ctx.fillStyle=glow;
            ctx.beginPath();
            ctx.arc(f.x,f.y,10,0,Math.PI*2);
            ctx.fill();

            const dx=player.points[0].x-f.x;
            const dy=player.points[0].y-f.y;

            if(Math.hypot(dx,dy)<15){
                foods.splice(i,1);
                player.grow(25);
                spawnFood();
            }
        });
    }

    requestAnimationFrame(update);
}

init();
update();
</script>
