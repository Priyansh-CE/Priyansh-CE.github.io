<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Snake Arena ULTRA OFFLINE ELITE</title>
<style>
body{margin:0;overflow:hidden;background:#050816;font-family:Arial}
canvas{display:block}
#ui{
position:fixed;top:10px;left:10px;color:white;font-size:14px}
#menu{
position:fixed;top:50%;left:50%;
transform:translate(-50%,-50%);
color:white;text-align:center;display:none}
button{
padding:10px 20px;margin:10px;
border:none;background:#22c55e;
color:black;font-weight:bold;cursor:pointer}
#leaderboard{
position:fixed;top:10px;right:10px;
color:white;font-size:14px;text-align:right}
</style>
</head>
<body>

<canvas id="game"></canvas>

<div id="ui">
Level: <span id="level">1</span><br>
XP: <span id="xp">0</span><br>
Boost: <span id="boost">100</span><br>
Rank: <span id="rank">Bronze</span>
</div>

<div id="leaderboard"></div>

<div id="menu">
<h1>GAME OVER</h1>
<p id="score"></p>
<button onclick="restart()">Restart</button>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth;
canvas.height=innerHeight;

const WORLD=6000;

let player,enemies=[],foods=[],particles=[];
let gameOver=false;
let shake=0;
let zoom=1;

let savedXP=parseInt(localStorage.getItem("xp"))||0;
let savedLevel=parseInt(localStorage.getItem("level"))||1;

class Snake{
constructor(x,y,color,isAI=false,isBoss=false){
this.points=[];
this.angle=0;
this.targetAngle=0;
this.speed=isBoss?1.5:2;
this.baseSpeed=this.speed;
this.length=isBoss?1500:300;
this.radius=isBoss?20:10;
this.color=color;
this.isAI=isAI;
this.isBoss=isBoss;
this.alive=true;
this.stamina=100;
this.xp=0;
this.level=1;

for(let i=0;i<200;i++)
this.points.push({x:x-i,y:y});
}

update(){
if(!this.alive)return;

if(this.isAI){
let dx=player.points[0].x-this.points[0].x;
let dy=player.points[0].y-this.points[0].y;
this.targetAngle=Math.atan2(dy,dx);
}

let diff=this.targetAngle-this.angle;
diff=Math.atan2(Math.sin(diff),Math.cos(diff));
this.angle+=diff*0.08;

let head=this.points[0];
let nx=head.x+Math.cos(this.angle)*this.speed;
let ny=head.y+Math.sin(this.angle)*this.speed;
this.points.unshift({x:nx,y:ny});

let total=0;
for(let i=0;i<this.points.length-1;i++){
let dx=this.points[i].x-this.points[i+1].x;
let dy=this.points[i].y-this.points[i+1].y;
total+=Math.hypot(dx,dy);
if(total>this.length){
this.points.splice(i+1);
break;
}
}
}

draw(){
if(!this.alive)return;
ctx.lineWidth=this.radius*2;
ctx.lineCap="round";
ctx.strokeStyle=this.color;
ctx.shadowColor=this.color;
ctx.shadowBlur=this.isBoss?30:15;
ctx.beginPath();
ctx.moveTo(this.points[0].x,this.points[0].y);
for(let i=1;i<this.points.length;i++)
ctx.lineTo(this.points[i].x,this.points[i].y);
ctx.stroke();
ctx.shadowBlur=0;
}
}

function spawnFood(){
foods.push({
x:Math.random()*WORLD,
y:Math.random()*WORLD,
rare:Math.random()<0.05
});
}

function explosion(x,y,color){
shake=20;
for(let i=0;i<40;i++){
particles.push({
x,y,
vx:(Math.random()-0.5)*10,
vy:(Math.random()-0.5)*10,
life:60,
color});
}
}

function init(){
player=new Snake(WORLD/2,WORLD/2,"#22c55e");
player.level=savedLevel;
player.xp=savedXP;

enemies=[];
foods=[];
particles=[];
gameOver=false;

for(let i=0;i<400;i++)spawnFood();

for(let i=0;i<6;i++)
enemies.push(new Snake(Math.random()*WORLD,
Math.random()*WORLD,"#ef4444",true));

enemies.push(new Snake(1000,1000,"#9333ea",true,true));
}

canvas.addEventListener("mousemove",e=>{
player.targetAngle=Math.atan2(
e.clientY-canvas.height/2,
e.clientX-canvas.width/2);
});

document.addEventListener("keydown",e=>{
if(e.key==="Shift"&&player.stamina>0)
player.speed=4;
});

document.addEventListener("keyup",e=>{
if(e.key==="Shift")
player.speed=player.baseSpeed;
});

function updateRank(){
let rank="Bronze";
if(player.level>5)rank="Silver";
if(player.level>10)rank="Gold";
if(player.level>20)rank="Diamond";
document.getElementById("rank").innerText=rank;
}

function playerDeath(){
gameOver=true;
player.alive=false;
explosion(player.points[0].x,
player.points[0].y,player.color);
document.getElementById("score").innerText=
"Score: "+Math.floor(player.length);
document.getElementById("menu").style.display="block";
}

function update(){
ctx.fillStyle="#050816";
ctx.fillRect(0,0,canvas.width,canvas.height);

if(!gameOver){

zoom=1-Math.min(player.length/8000,0.4);

ctx.save();
ctx.translate(
(Math.random()-0.5)*shake,
(Math.random()-0.5)*shake);

let camX=player.points[0].x-canvas.width/2;
let camY=player.points[0].y-canvas.height/2;
ctx.scale(zoom,zoom);
ctx.translate(-camX,-camY);

foods.forEach((f,i)=>{
ctx.fillStyle=f.rare?"#facc15":"#fde047";
ctx.beginPath();
ctx.arc(f.x,f.y,f.rare?12:6,0,Math.PI*2);
ctx.fill();

let dx=player.points[0].x-f.x;
let dy=player.points[0].y-f.y;
if(Math.hypot(dx,dy)<15){
foods.splice(i,1);
player.length+=f.rare?200:30;
player.xp+=10;
if(player.xp>=100){
player.level++;
player.xp=0;
}
localStorage.setItem("xp",player.xp);
localStorage.setItem("level",player.level);
spawnFood();
}
});

player.update();
enemies.forEach(e=>e.update());

player.draw();
enemies.forEach(e=>e.draw());

ctx.restore();
shake*=0.9;
updateRank();
}

particles.forEach((p,i)=>{
p.x+=p.vx;
p.y+=p.vy;
p.life--;
ctx.fillStyle=p.color;
ctx.beginPath();
ctx.arc(p.x,p.y,3,0,Math.PI*2);
ctx.fill();
if(p.life<=0)particles.splice(i,1);
});

player.stamina=Math.min(100,
player.stamina+(player.speed===player.baseSpeed?0.5:-1));

document.getElementById("boost").innerText=
Math.floor(player.stamina);
document.getElementById("level").innerText=player.level;
document.getElementById("xp").innerText=player.xp;

let fakePlayers=[player,...enemies];
fakePlayers.sort((a,b)=>b.length-a.length);
let text="<b>Leaderboard</b><br>";
fakePlayers.slice(0,5).forEach((s,i)=>{
text+=(i+1)+". "+(s.isBoss?"BOSS":(s.isAI?"AI":"YOU"))+
" ("+Math.floor(s.length)+")<br>";
});
document.getElementById("leaderboard").innerHTML=text;

requestAnimationFrame(update);
}

function restart(){
document.getElementById("menu").style.display="none";
init();
}

init();
update();
</script>
</body>
</html>
