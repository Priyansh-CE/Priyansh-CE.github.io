<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Pro Snake Arena</title>
<style>
body{
    margin:0;
    overflow:hidden;
    background:#0b1220;
    font-family:Arial;
}
canvas{display:block;}

#menu{
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    text-align:center;
    display:none;
}
button{
    padding:12px 25px;
    font-size:18px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    background:#22c55e;
    color:white;
}
</style>
</head>
<body>

<canvas id="game"></canvas>

<div id="menu">
<h2 style="color:white">GAME OVER</h2>
<button onclick="init()">Restart</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player, enemy, foods=[], particles=[];
let gameOver=false;

class Snake{
    constructor(x,y,color,isAI=false){
        this.points=[];
        this.speed=2.2;
        this.angle=0;
        this.length=300;
        this.radius=10;
        this.color=color;
        this.isAI=isAI;

        for(let i=0;i<200;i++){
            this.points.push({x:x-i,y:y});
        }
    }

    update(){
        if(this.isAI){
            // simple AI hunts nearest food
            let nearest = foods[0];
            let minDist = Infinity;
            foods.forEach(f=>{
                let d = Math.hypot(this.points[0].x-f.x,
                                   this.points[0].y-f.y);
                if(d < minDist){
                    minDist = d;
                    nearest = f;
                }
            });
            if(nearest){
                this.angle = Math.atan2(
                    nearest.y-this.points[0].y,
                    nearest.x-this.points[0].x
                );
            }
        }

        const head = this.points[0];
        const nx = head.x + Math.cos(this.angle)*this.speed;
        const ny = head.y + Math.sin(this.angle)*this.speed;

        this.points.unshift({x:nx,y:ny});

        let totalLength=0;
        for(let i=0;i<this.points.length-1;i++){
            const dx=this.points[i].x-this.points[i+1].x;
            const dy=this.points[i].y-this.points[i+1].y;
            totalLength+=Math.hypot(dx,dy);

            if(totalLength>this.length){
                this.points.splice(i+1);
                break;
            }
        }
    }

    grow(n){
        this.length+=n;
    }

    draw(){
        ctx.lineCap="round";
        ctx.lineJoin="round";
        ctx.lineWidth=this.radius*2;

        const gradient=ctx.createLinearGradient(
            this.points[0].x,
            this.points[0].y,
            this.points[30]?.x || this.points[0].x,
            this.points[30]?.y || this.points[0].y
        );
        gradient.addColorStop(0,this.color);
        gradient.addColorStop(1,"#000");

        ctx.strokeStyle=gradient;
        ctx.shadowColor=this.color;
        ctx.shadowBlur=20;

        ctx.beginPath();
        ctx.moveTo(this.points[0].x,this.points[0].y);
        for(let i=1;i<this.points.length;i++){
            ctx.lineTo(this.points[i].x,this.points[i].y);
        }
        ctx.stroke();

        ctx.shadowBlur=0;

        // scale texture effect
        for(let i=0;i<this.points.length;i+=8){
            ctx.beginPath();
            ctx.arc(this.points[i].x,this.points[i].y,2,0,Math.PI*2);
            ctx.fillStyle="rgba(255,255,255,0.08)";
            ctx.fill();
        }
    }
}

function spawnFood(x,y){
    foods.push({
        x:x || Math.random()*canvas.width,
        y:y || Math.random()*canvas.height
    });
}

function explodeSnake(snake){
    snake.points.forEach(p=>{
        for(let i=0;i<2;i++){
            particles.push({
                x:p.x,
                y:p.y,
                dx:(Math.random()-0.5)*5,
                dy:(Math.random()-0.5)*5,
                life:60
            });
        }
        spawnFood(p.x,p.y);
    });
}

function init(){
    player=new Snake(canvas.width/2,canvas.height/2,"#4ade80");
    enemy=new Snake(200,200,"#ef4444",true);
    foods=[];
    particles=[];
    for(let i=0;i<80;i++) spawnFood();
    gameOver=false;
    document.getElementById("menu").style.display="none";
}

canvas.addEventListener("mousemove",e=>{
    player.angle=Math.atan2(
        e.clientY-player.points[0].y,
        e.clientX-player.points[0].x
    );
});

function checkCollision(){
    enemy.points.forEach(seg=>{
        if(Math.hypot(player.points[0].x-seg.x,
                      player.points[0].y-seg.y)<12){
            explodeSnake(player);
            gameOver=true;
            document.getElementById("menu").style.display="block";
        }
    });
}

function update(){
    ctx.fillStyle="#0b1220";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    if(!gameOver){
        player.update();
        enemy.update();

        player.draw();
        enemy.draw();

        foods.forEach((f,i)=>{
            ctx.beginPath();
            ctx.arc(f.x,f.y,6,0,Math.PI*2);
            ctx.fillStyle="#fde047";
            ctx.fill();

            if(Math.hypot(player.points[0].x-f.x,
                          player.points[0].y-f.y)<15){
                foods.splice(i,1);
                player.grow(30);
                spawnFood();
            }
        });

        checkCollision();
    }

    // particles
    particles.forEach((p,i)=>{
        p.x+=p.dx;
        p.y+=p.dy;
        p.life--;
        ctx.fillStyle="orange";
        ctx.fillRect(p.x,p.y,3,3);
        if(p.life<=0) particles.splice(i,1);
    });

    requestAnimationFrame(update);
}

init();
update();
</script>

</body>
</html>
